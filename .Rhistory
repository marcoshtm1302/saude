panel.grid.minor = element_blank(),
panel.grid.major.y = element_line(color = "#E0E0E0", linewidth = 0.5),
# Eixos
axis.text.x = element_text(size = 12, face = "bold", color = "black", margin = margin(t=10)),
axis.text.y = element_text(size = 10, color = "grey40"),
axis.title.y = element_text(size = 11, color = "grey40", margin = margin(r=10)),
axis.title.y.right = element_text(angle = 90, margin = margin(l=10)), # Rotaciona titulo da direita
# Legenda
legend.position = "bottom",
legend.text = element_text(size = 10, color = "grey30"),
legend.box.spacing = unit(0.2, "cm"),
# Títulos
plot.title = element_text(size = 16, face = "plain", hjust = 0.5, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "grey50", hjust = 0.5, margin = margin(b = 20)),
plot.caption = element_text(size = 8, color = "grey60", hjust = 0, margin = margin(t = 15))
)
# Plotar
print(g)
#| label: grafico-financiamento-saude
#| fig-width: 12
#| fig-height: 6
#| warning: false
#| message: false
# BLOCO 2
library(ggplot2)
library(scales)
library(dplyr)
library(stringr)
# --- 1. CÁLCULOS PRÉVIOS (Recalculando para garantir integridade) ---
# Fator de escala: Sincroniza R$ (Milhões) com % (0-100)
# Lógica: O teto do eixo Y será 15% maior que o maior valor financeiro encontrado
max_valor_fin <- max(dados_percentuais$total_ano, na.rm = TRUE)
limite_sup_dinamico <- max_valor_fin * 1.15
fator_escala <- limite_sup_dinamico / 100
# --- 2. CONSTRUÇÃO DO GRÁFICO ---
g <- ggplot() +
# A. Camada de Barras (Volume Financeiro)
geom_col(data = dados_grafico,
aes(x = factor(ano_referencia), y = total_ano_cat, fill = categoria),
width = 0.65,
# ALTERAÇÃO AQUI: Adicione reverse = TRUE
position = position_stack(reverse = TRUE)) +
# B. Rótulos Internos das Barras (Valor em R$)
geom_text(data = dados_grafico,
aes(x = factor(ano_referencia), y = total_ano_cat,
group = categoria,
label = number(total_ano_cat, prefix = "R$ ", suffix = "M",
accuracy = 0.1, big.mark = ".", decimal.mark = ",")),
# ALTERAÇÃO AQUI: Mantenha o vjust e adicione reverse = TRUE
position = position_stack(vjust = 0.5, reverse = TRUE),
color = "white", fontface = "bold", size = 5.5) +
# C. Camada de Linha (% Recursos Próprios)
# Usamos o fator_escala para elevar a linha à altura correta visualmente
geom_line(data = dados_percentuais,
aes(x = factor(ano_referencia), y = pct * fator_escala, group = 1),
color = "#2c3e50", linewidth = 1.2, linetype = "solid") + # Linha cinza escuro sólida
geom_point(data = dados_percentuais,
aes(x = factor(ano_referencia), y = pct * fator_escala),
color = "#2c3e50", fill = "white", shape = 21, size = 4, stroke = 1.5) +
# --- 3. ESCALAS E EIXOS (A Mágica do Eixo Duplo) ---
scale_y_continuous(
# Eixo Primário (Esquerda - Dinheiro)
name = "Desembolso Total (R$)",
labels = label_number(scale = 1, prefix = "R$ ", suffix = "M", big.mark = ".", decimal.mark = ","),
limits = c(0, limite_sup_dinamico), # Garante espaço para o rótulo da linha não cortar
expand = c(0, 0),
# Eixo Secundário (Direita - Porcentagem)
# A transformação inversa: . / fator_escala
sec.axis = sec_axis(~ . / fator_escala,
name = "Participação de Rec. Próprios (%)",
labels = function(x) paste0(round(x, 0), "%"))
) +
# Cores Profissionais (Inspirado no estilo 'Gold Standard')
# Laranja queimado para Próprios (destaque) e Azul Petróleo para Vinculados
scale_fill_manual(values = c(
"1. Recursos Livres (Próprios + 15%)" = "#E67E22",
"2. Recursos Vinculados (SUS/Convênios)" = "#34495E"
)) +
# --- 4. TEMA E ESTÉTICA ---
labs(
title = str_wrap("Composição do Financiamento da Saúde: Esforço Municipal vs. Transferências", width = 60),
subtitle = "Evolução do volume pago (barras) e participação percentual dos recursos livres (linha)",
x = NULL,
fill = NULL, # Remove título da legenda para limpar
caption = "Fonte: Contabilidade Municipal | Fonte 103/000 vs Outras Fontes"
) +
theme_minimal() +
theme(
# Grid
panel.grid.major.x = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_line(color = "#E0E0E0", linewidth = 0.5),
# Eixos
axis.text.x = element_text(size = 12, face = "bold", color = "black", margin = margin(t=10)),
axis.text.y = element_text(size = 10, color = "grey40"),
axis.title.y = element_text(size = 11, color = "grey40", margin = margin(r=10)),
axis.title.y.right = element_text(angle = 90, margin = margin(l=10)), # Rotaciona titulo da direita
# Legenda
legend.position = "bottom",
legend.text = element_text(size = 10, color = "grey30"),
legend.box.spacing = unit(0.2, "cm"),
# Títulos
plot.title = element_text(size = 16, face = "plain", hjust = 0.5, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "grey50", hjust = 0.5, margin = margin(b = 20)),
plot.caption = element_text(size = 8, color = "grey60", hjust = 0, margin = margin(t = 15))
)
# Plotar
print(g)
# preparação
#| echo: false
#| message: false
#| warning: false
# BLOCO 1: PREPARAÇÃO (CURVA ABC FORNECEDORES)
library(dplyr)
library(stringr)
library(scales)
# 1. Definir o ano de análise (Pega o último ano presente nos dados)
ano_analise_fornecedor <- max(df_despesas_limpo$ano_referencia, na.rm = TRUE)
# 2. Agrupamento e Ranking
df_fornecedores_top <- df_despesas_limpo %>%
filter(ano_referencia == ano_analise_fornecedor) %>%
# Agrupa por fornecedor e soma o valor PAGO
group_by(fornecedor) %>%
summarise(total_pago = sum(pago, na.rm = TRUE), .groups = "drop") %>%
# Calcula percentuais e ranking
mutate(
pct_total = total_pago / sum(total_pago),
ranking = rank(-total_pago) # Rank descrescente (1 é o maior)
) %>%
# Ordena do maior para o menor
arrange(desc(total_pago)) %>%
# Pega apenas os Top 10 para o gráfico
slice_head(n = 10) %>%
mutate(
# Tratamento de Strings: Limita nomes muito longos para não quebrar o gráfico
# Ex: "CONSORCIO INTERMUNICIPAL..." vira "CONSORCIO INTERMUN..."
fornecedor_abrev = str_trunc(fornecedor, 40, "right"),
# Cria o rótulo combinado (Valor + Porcentagem) para o gráfico
# Ex: R$ 500.000 (10.5%)
label_final = paste0(
number(total_pago, prefix = "R$ ", big.mark = ".", decimal.mark = ",", accuracy = 1, scale = 1),
" (", percent(pct_total, accuracy = 0.1), ")"
)
)
# Cálculo de Totais para o Texto Dinâmico
total_top10 <- sum(df_fornecedores_top$total_pago)
total_orcamento_ano <- sum(df_despesas_limpo$pago[df_despesas_limpo$ano_referencia == ano_analise_fornecedor], na.rm = TRUE)
pct_top10 <- (total_top10 / total_orcamento_ano) * 100
# Dados do TOP 1 (O maior credor)
top1_nome <- df_fornecedores_top$fornecedor[1]
top1_pct  <- df_fornecedores_top$pct_total[1] * 100
#| label: grafico-top-fornecedores
#| fig-width: 12
#| fig-height: 7
#| warning: false
#| message: false
# BLOCO 3: GRÁFICO (CORRIGIDO)
library(ggplot2)
library(scales)
# Criação do Gráfico
# CORREÇÃO CRÍTICA AQUI: Mudamos de fornecedor_abrev para fornecedor_fmt
ggplot(df_fornecedores_top, aes(x = total_pago, y = reorder(fornecedor_fmt, total_pago))) +
# A. Barras com Gradiente baseado no valor
geom_col(aes(fill = total_pago), width = 0.75, show.legend = FALSE) +
# B. Definição das Cores (Gradiente Roxo -> Verde/Azul)
scale_fill_gradient(low = "#7FB3D5", high = "#4A235A") +
# C. Rótulos de Dados
geom_text(aes(label = label_final),
hjust = -0.1,
fontface = "bold",
color = "#404040",
size = 4) +
# D. Ajuste da Escala X
scale_x_continuous(
labels = label_number(scale = 1e-6, prefix = "R$ ", suffix = "M", big.mark = ".", decimal.mark = ","),
expand = expansion(mult = c(0, 0.3))
) +
# E. Títulos
labs(
title = paste0("Top 10 Fornecedores - Secretaria de Saúde (", ano_analise_fornecedor, ")"),
subtitle = "Ranking dos credores por volume financeiro pago",
x = "Volume Total Pago (Milhões R$)",
y = NULL,
caption = "Fonte: Sistema de Gestão Financeira | Filtragem: Status 'Pago'"
) +
# F. Tema Clean com Ajuste de Quebra de Linha
theme_minimal() +
theme(
# CORREÇÃO ESTÉTICA: lineheight ajusta o espaçamento das linhas quebradas
axis.text.y = element_text(size = 11, face = "bold", color = "#2c3e50", lineheight = 0.8),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_line(color = "#e0e0e0", linetype = "dashed"),
plot.title = element_text(size = 16, face = "bold", color = "#2c3e50"),
plot.subtitle = element_text(size = 12, color = "grey50", margin = margin(b = 20)),
plot.margin = margin(t = 20, r = 20, b = 20, l = 10)
)
# preparação
#| echo: false
#| message: false
#| warning: false
# BLOCO 1: PREPARAÇÃO (CURVA ABC FORNECEDORES)
library(dplyr)
library(stringr)
library(scales)
# 1. Definir o ano de análise (Pega o último ano presente nos dados)
ano_analise_fornecedor <- max(df_despesas_limpo$ano_referencia, na.rm = TRUE)
# 2. Agrupamento e Ranking
df_fornecedores_top <- df_despesas_limpo %>%
filter(ano_referencia == ano_analise_fornecedor) %>%
# Agrupa por fornecedor e soma o valor PAGO
group_by(fornecedor) %>%
summarise(total_pago = sum(pago, na.rm = TRUE), .groups = "drop") %>%
# Calcula percentuais e ranking
mutate(
pct_total = total_pago / sum(total_pago),
ranking = rank(-total_pago) # Rank descrescente (1 é o maior)
) %>%
# Ordena do maior para o menor
arrange(desc(total_pago)) %>%
# Pega apenas os Top 10 para o gráfico
slice_head(n = 10) %>%
mutate(
# Tratamento de Strings: Limita nomes muito longos para não quebrar o gráfico
# Ex: "CONSORCIO INTERMUNICIPAL..." vira "CONSORCIO INTERMUN..."
fornecedor_fmt = str_wrap(fornecedor, width = 30),
# Cria o rótulo combinado (Valor + Porcentagem) para o gráfico
# Ex: R$ 500.000 (10.5%)
label_final = paste0(
number(total_pago, prefix = "R$ ", big.mark = ".", decimal.mark = ",", accuracy = 1, scale = 1),
" (", percent(pct_total, accuracy = 0.1), ")"
)
)
# Cálculo de Totais para o Texto Dinâmico
total_top10 <- sum(df_fornecedores_top$total_pago)
total_orcamento_ano <- sum(df_despesas_limpo$pago[df_despesas_limpo$ano_referencia == ano_analise_fornecedor], na.rm = TRUE)
pct_top10 <- (total_top10 / total_orcamento_ano) * 100
# Dados do TOP 1 (O maior credor)
top1_nome <- df_fornecedores_top$fornecedor[1]
top1_pct  <- df_fornecedores_top$pct_total[1] * 100
#| label: grafico-top-fornecedores
#| fig-width: 12
#| fig-height: 7
#| warning: false
#| message: false
# BLOCO 3: GRÁFICO (CORRIGIDO)
library(ggplot2)
library(scales)
# Criação do Gráfico
# CORREÇÃO CRÍTICA AQUI: Mudamos de fornecedor_abrev para fornecedor_fmt
ggplot(df_fornecedores_top, aes(x = total_pago, y = reorder(fornecedor_fmt, total_pago))) +
# A. Barras com Gradiente baseado no valor
geom_col(aes(fill = total_pago), width = 0.75, show.legend = FALSE) +
# B. Definição das Cores (Gradiente Roxo -> Verde/Azul)
scale_fill_gradient(low = "#7FB3D5", high = "#4A235A") +
# C. Rótulos de Dados
geom_text(aes(label = label_final),
hjust = -0.1,
fontface = "bold",
color = "#404040",
size = 4) +
# D. Ajuste da Escala X
scale_x_continuous(
labels = label_number(scale = 1e-6, prefix = "R$ ", suffix = "M", big.mark = ".", decimal.mark = ","),
expand = expansion(mult = c(0, 0.3))
) +
# E. Títulos
labs(
title = paste0("Top 10 Fornecedores - Secretaria de Saúde (", ano_analise_fornecedor, ")"),
subtitle = "Ranking dos credores por volume financeiro pago",
x = "Volume Total Pago (Milhões R$)",
y = NULL,
caption = "Fonte: Sistema de Gestão Financeira | Filtragem: Status 'Pago'"
) +
# F. Tema Clean com Ajuste de Quebra de Linha
theme_minimal() +
theme(
# CORREÇÃO ESTÉTICA: lineheight ajusta o espaçamento das linhas quebradas
axis.text.y = element_text(size = 11, face = "bold", color = "#2c3e50", lineheight = 0.8),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_line(color = "#e0e0e0", linetype = "dashed"),
plot.title = element_text(size = 16, face = "bold", color = "#2c3e50"),
plot.subtitle = element_text(size = 12, color = "grey50", margin = margin(b = 20)),
plot.margin = margin(t = 20, r = 20, b = 20, l = 10)
)
#| label: tabela-top15-fornecedores
#| echo: false
#| message: false
#| warning: false
# --- BLOCO 1: PREPARAÇÃO ---
library(dplyr)
library(stringr)
library(scales)
library(knitr)
library(kableExtra)
# 1. Definir o ano de análise
ano_analise_fornecedor <- max(df_despesas_limpo$ano_referencia, na.rm = TRUE)
# 2. Agrupamento e Ranking
df_fornecedores_top <- df_despesas_limpo %>%
filter(ano_referencia == ano_analise_fornecedor) %>%
group_by(fornecedor) %>%
summarise(total_pago = sum(pago, na.rm = TRUE), .groups = "drop") %>%
mutate(
pct_total = total_pago / sum(total_pago),
ranking = rank(-total_pago)
) %>%
arrange(desc(total_pago)) %>%
slice_head(n = 15)
# --- BLOCO 4: GERAÇÃO DA TABELA ---
# 1. Seleção e Formatação para Tabela
tabela_exibicao <- df_fornecedores_top %>%
select(ranking, fornecedor, total_pago, pct_total) %>%
mutate(
# Trunca texto muito longo para evitar quebra de layout
fornecedor = str_trunc(fornecedor, 90, "right"),
# Formatação de valores (Inteiros)
total_fmt = number(total_pago, prefix = "R$ ", big.mark = ".", decimal.mark = ",", accuracy = 1),
pct_fmt = percent(pct_total, accuracy = 0.1, decimal.mark = ",")
) %>%
select(ranking, fornecedor, total_fmt, pct_fmt)
# 2. Gerar Tabela Visual
kable(tabela_exibicao,
caption = "Detalhamento dos 15 Maiores Fornecedores (Valores Nominais)",
col.names = c("Rank", "Fornecedor / Razão Social", "Valor Pago", "Part. (%)"),
align = c('c', 'l', 'r', 'c')) %>%
# Estilização Geral
kable_styling(
bootstrap_options = c("striped", "condensed", "hover"),
full_width = TRUE,
font_size = 10,
position = "center"
) %>%
# Cabeçalho
row_spec(0, bold = TRUE, font_size = 11, background = "#f2f2f2", color = "black") %>%
# Colunas (Pipes conectados corretamente)
column_spec(1, width = "5%") %>%
column_spec(2, width = "65%") %>%
column_spec(3, width = "20%") %>%
column_spec(4, width = "10%")
#| label: tabela-top15-fornecedores
#| echo: false
#| message: false
#| warning: false
# BLOCO 4: TABELA COMPACTA (ESTILO CONFERÊNCIA)
library(knitr)
library(dplyr)
library(scales)
library(kableExtra)
# 1. Seleção e Formatação
tabela_fornecedores <- df_fornecedores_top %>%
select(ranking, fornecedor, total_pago, pct_total) %>%
mutate(
# Truncar em 50 caracteres: Evita quebra de linha excessiva (economiza altura)
fornecedor = str_trunc(fornecedor, 50, "right"),
total_fmt = number(total_pago, prefix = "R$ ", big.mark = ".", decimal.mark = ",", accuracy = 1),
pct_fmt = percent(pct_total, accuracy = 0.1, decimal.mark = ",")
) %>%
select(ranking, fornecedor, total_fmt, pct_fmt)
# 2. Gerar Tabela Compacta
kable(tabela_fornecedores,
caption = "Top 15 Fornecedores (Valores Nominais)",
col.names = c("Rank", "Fornecedor / Credor", "Valor Pago", "%"),
align = c('c', 'l', 'r', 'c'),
booktabs = TRUE) %>% # booktabs cria linhas horizontais mais elegantes
# --- ESTILIZAÇÃO PDF/LATEX ---
kable_styling(
# "striped": linhas zebradas facilitam leitura
# "hold_position": força a tabela a ficar exatamente onde você colocou o código
latex_options = c("striped", "hold_position"),
full_width = FALSE,      # FALSE é crucial para não dar erro no PDF
font_size = 9,           # Fonte pequena para ser discreta/compacta
position = "center"
) %>%
# Cabeçalho Compacto (Cinza claro e negrito)
row_spec(0, bold = TRUE, background = "#f0f0f0", font_size = 10) %>%
# --- CONTROLE FINO DE LARGURA (Total ~14.5cm) ---
# Isso garante que as colunas fiquem próximas, sem "vãos" grandes
column_spec(1, width = "1.0cm") %>%   # Rank
column_spec(2, width = "9.0cm") %>%   # Nome (Espaço suficiente para não quebrar muito)
column_spec(3, width = "3.0cm") %>%   # Valor
column_spec(4, width = "1.5cm")       # %
#| echo: false
#| message: false
#| warning: false
# BLOCO 1: PREPARAÇÃO COMPARATIVA (2024 vs 2025)
library(dplyr)
library(tidyr)
library(stringr)
library(scales)
# 1. Filtrar anos de interesse e agrupar
df_comp_raw <- df_despesas_limpo %>%
filter(ano_referencia %in% c(2024, 2025)) %>%
group_by(fornecedor, ano_referencia) %>%
summarise(total_pago = sum(pago, na.rm = TRUE), .groups = "drop")
# 2. Pivotar para formato Wide (Lado a Lado) para calcular variações
df_comp_wide <- df_comp_raw %>%
pivot_wider(names_from = ano_referencia, values_from = total_pago, names_prefix = "ano_") %>%
# Substituir NAs por 0 (casos onde não houve pagamento em um dos anos)
mutate(
ano_2024 = replace_na(ano_2024, 0),
ano_2025 = replace_na(ano_2025, 0)
) %>%
# Filtrar apenas quem teve pagamento em 2025 (Foco da gestão atual)
filter(ano_2025 > 0) %>%
# Pegar TOP 10 de 2025
arrange(desc(ano_2025)) %>%
slice_head(n = 10) %>%
# 3. Calcular Indicadores de Variação
mutate(
diff_nominal = ano_2025 - ano_2024,
# Lógica Percentual e Status
status = case_when(
ano_2024 == 0 ~ "NOVO",
ano_2025 > ano_2024 ~ "AUMENTO",
ano_2025 < ano_2024 ~ "REDUCAO",
TRUE ~ "ESTAVEL"
),
pct_var = case_when(
ano_2024 > 0 ~ (ano_2025 - ano_2024) / ano_2024,
TRUE ~ 0
),
# Etiqueta Formatada para o Gráfico (Evitando caracteres Unicode problemáticos)
label_var = case_when(
status == "NOVO" ~ " NOVO",
status == "AUMENTO" ~ paste0("+", percent(pct_var, accuracy = 0.1)),
status == "REDUCAO" ~ percent(pct_var, accuracy = 0.1), # O sinal de menos já vem automático
TRUE ~ "-"
),
# Definir cores para o rótulo
cor_label = case_when(
status == "NOVO" ~ "#27AE60",    # Verde (Novidade)
status == "AUMENTO" ~ "#C0392B", # Vermelho (Alerta de gasto)
status == "REDUCAO" ~ "#2980B9", # Azul (Economia)
TRUE ~ "grey50"
),
# Tratar nomes para o eixo Y
fornecedor_fmt = str_trunc(fornecedor, 40, "right")
)
# 4. Pivotar de volta para Long (Formato que o ggplot gosta para barras agrupadas)
df_plot_comp <- df_comp_wide %>%
pivot_longer(cols = c("ano_2024", "ano_2025"),
names_to = "ano",
values_to = "valor") %>%
mutate(
ano_label = if_else(ano == "ano_2024", "2024", "2025")
)
# --- DADOS PARA O TEXTO ---
# Contagem de novos fornecedores no top 10
qtd_novos <- sum(df_comp_wide$status == "NOVO")
# Maior aumento percentual (excluindo novos)
maior_aumento <- df_comp_wide %>%
filter(status == "AUMENTO") %>%
arrange(desc(pct_var)) %>%
slice(1)
nome_maior_aumento <- if(nrow(maior_aumento) > 0) maior_aumento$fornecedor_fmt else "Nenhum"
pct_maior_aumento <- if(nrow(maior_aumento) > 0) percent(maior_aumento$pct_var, accuracy=1) else "0%"
#| label: grafico-comp-fornecedores
#| fig-width: 12
#| fig-height: 8
#| warning: false
#| message: false
# BLOCO 3: GRÁFICO COMPARATIVO
library(ggplot2)
library(scales)
ggplot(df_plot_comp, aes(x = valor, y = reorder(fornecedor_fmt, valor))) +
# A. Barras Agrupadas (Dodge)
# position_dodge(0.8) coloca as barras uma ao lado da outra
geom_col(aes(fill = ano_label, alpha = ano_label),
position = position_dodge(width = 0.8),
width = 0.7) +
# B. Rótulos de Variação (Apenas na barra de 2025)
# Usamos o dataframe original (WIDE) para plotar o texto apenas uma vez por fornecedor
geom_text(data = df_comp_wide,
aes(x = ano_2025, y = fornecedor_fmt,
label = label_var, color = cor_label),
# Ajuste fino da posição: desloca um pouco para a direita da barra azul
hjust = -0.15,
vjust = 0.5, # Alinha com o centro do grupo (mais próximo da barra azul devido à lógica visual)
position = position_nudge(y = -0.15), # Empurra levemente para baixo para alinhar com a barra de 2025
fontface = "bold",
size = 3.5) +
# C. Configuração de Cores (Cinza vs Azul)
scale_fill_manual(values = c("2024" = "#BDC3C7", "2025" = "#2980B9")) +
scale_alpha_manual(values = c("2024" = 0.7, "2025" = 1.0)) + # 2024 mais transparente
# D. Mapeamento de Cores do Texto (Identidade direta sem legenda)
scale_color_identity() +
# E. Eixos e Escalas
scale_x_continuous(
labels = label_number(scale = 1e-6, prefix = "R$ ", suffix = "M", big.mark = ".", decimal.mark = ","),
# Expansão generosa à direita para caber os rótulos de porcentagem
expand = expansion(mult = c(0, 0.2))
) +
# F. Títulos e Legendas
labs(
title = "Dinâmica de Fornecedores: Comparativo 2024 vs 2025",
subtitle = "Variação de gastos nos Top 10 principais contratos do ano atual",
x = "Volume Pago (R$)",
y = NULL,
fill = "Exercício",
alpha = "Exercício",
caption = "Nota: Rótulos indicam variação percentual sobre 2024. 'NOVO' indica ausência de pagamentos no ano anterior."
) +
# G. Tema Clean
theme_minimal() +
theme(
legend.position = c(0.85, 0.15), # Legenda flutuante no canto inferior direito
legend.background = element_rect(fill = "white", color = "grey90"),
axis.text.y = element_text(size = 10, face = "bold", color = "#2c3e50"),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_line(color = "#e0e0e0", linetype = "dashed"),
plot.title = element_text(size = 14, face = "bold"),
plot.margin = margin(t=20, r=20, b=20, l=10)
)
